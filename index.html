<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>atyr - Fashion Mix & Match</title>
    
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent;
        }
        
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap');
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #f8f6f0 0%, #ffffff 50%, #f0f2f5 100%);
            min-height: 100vh; 
            color: #2c3e50;
            overflow-x: hidden;
            position: relative;
            touch-action: manipulation;
        }
        
        /* Cool Intro Animation */
        .intro-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 1;
            transition: all 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .intro-animation.hidden {
            opacity: 0;
            transform: scale(0.8) translateY(-50px);
            pointer-events: none;
        }

        .intro-content {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .intro-logo {
            margin-bottom: 60px;
            animation: logoFloat 3s ease-in-out infinite;
        }

        .logo-text {
            font-family: 'Playfair Display', serif;
            font-size: 4.5rem;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
            animation: logoGlow 2s ease-in-out infinite alternate;
        }

        .logo-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 300;
            letter-spacing: 2px;
            text-transform: uppercase;
            animation: subtitleFade 2s ease-in-out infinite alternate;
        }

        .intro-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: particleFloat 6s linear infinite;
        }

        .particle:nth-child(1) {
            top: 20%;
            left: 20%;
            animation-delay: 0s;
            animation-duration: 8s;
        }

        .particle:nth-child(2) {
            top: 30%;
            right: 20%;
            animation-delay: 1s;
            animation-duration: 7s;
        }

        .particle:nth-child(3) {
            bottom: 30%;
            left: 30%;
            animation-delay: 2s;
            animation-duration: 9s;
        }

        .particle:nth-child(4) {
            bottom: 20%;
            right: 30%;
            animation-delay: 3s;
            animation-duration: 6s;
        }

        .particle:nth-child(5) {
            top: 50%;
            left: 50%;
            animation-delay: 4s;
            animation-duration: 8s;
        }

        .intro-loading {
            margin-top: 40px;
        }

        .loading-bar {
            width: 300px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            margin: 0 auto 20px;
            overflow: hidden;
            position: relative;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #ffffff, #f093fb, #ffffff);
            border-radius: 2px;
            width: 0%;
            animation: loadingProgress 3s ease-in-out forwards;
            position: relative;
        }

        .loading-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            animation: loadingShimmer 1.5s ease-in-out infinite;
        }

        .loading-text {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            font-weight: 300;
            animation: loadingTextPulse 2s ease-in-out infinite;
        }

        /* Animations */
        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes logoGlow {
            0% { text-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); }
            100% { text-shadow: 0 15px 40px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 255, 255, 0.3); }
        }

        @keyframes subtitleFade {
            0% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        @keyframes particleFloat {
            0% { 
                transform: translateY(0px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes loadingProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        @keyframes loadingShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes loadingTextPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Landing Screen */
        .landing-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #9CAF88 0%, #8BA077 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .landing-screen.hidden {
            transform: translateY(-100%);
            opacity: 0;
        }
        
        .logo-container {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .logo-text {
            font-size: 3rem;
            font-weight: 300;
            color: white;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            opacity: 0;
            transform: translateY(30px);
            animation: logoSlideIn 1s ease-out 0.5s forwards;
        }
        
        .logo-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 300;
            opacity: 0;
            transform: translateY(20px);
            animation: logoSlideIn 1s ease-out 1s forwards;
        }
        
        .loading-dots {
            display: flex;
            gap: 8px;
            margin-top: 2rem;
            opacity: 0;
            animation: logoSlideIn 1s ease-out 1.5s forwards;
            justify-content: center;
            align-items: center;
        }
        
        .dot {
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            animation: dotPulse 1.5s ease-in-out infinite;
        }
        
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes logoSlideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes dotPulse {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1.2); opacity: 1; }
        }
        
        /* Main App */
        .main-app {
            display: none;
            min-height: 100vh;
            background: transparent;
        }
        
        .main-app.active {
            display: block;
        }
        
        /* Header */
        .header {
            background: white;
            padding: 1rem 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: 300;
            color: #9CAF88;
            letter-spacing: 0.1em;
        }
        
        .nav-buttons {
            display: flex;
            gap: 1rem;
        }
        
        .nav-btn {
            background: rgba(156, 175, 136, 0.08);
            border: 2px solid rgba(156, 175, 136, 0.3);
            color: #9CAF88;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(156, 175, 136, 0.1);
        }
        
        .nav-btn:hover {
            background: #9CAF88;
            color: white;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(156, 175, 136, 0.3);
            border-color: #9CAF88;
        }
        
        /* Welcome Message */
        .welcome-message {
            background: linear-gradient(135deg, #9CAF88, #8BA077);
            color: white;
            padding: 1rem 1.5rem;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        /* Main Content */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        /* Carousel Container */
        .carousel-container {
            display: flex;
            flex-direction: column;
            gap: 0;
            align-items: center;
            margin-bottom: 2rem;
            max-width: 400px;
            margin: 0 auto 2rem auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.12), 0 8px 25px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        
        .carousel-container:hover {
            transform: translateY(-8px);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.15), 0 12px 35px rgba(0, 0, 0, 0.1);
        }
        
        .carousel-section {
            width: 100%;
            position: relative;
        }
        
        .carousel-section:first-child {
            margin-bottom: -40px;
            z-index: 2;
        }
        
        .carousel-section:last-child {
            z-index: 1;
        }
        
        .carousel {
            width: 100%;
            height: 350px;
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #ffffff 0%, #fafbfc 100%);
            border-radius: 20px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .carousel:first-child {
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: -5px;
        }
        
        .carousel-controls {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }
        
        .carousel-controls.left {
            left: 10px;
        }
        
        .carousel-controls.right {
            right: 10px;
        }
        
        .carousel-controls button {
            background: rgba(255, 255, 255, 0.9);
            color: #9CAF88;
            border: 2px solid #9CAF88;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(156, 175, 136, 0.2);
        }
        
        .carousel-controls button:hover {
            background: #9CAF88;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(156, 175, 136, 0.3);
        }
        
        .buy-together-section {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .secondary-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        
        .action-btn {
            background: rgba(255, 255, 255, 0.95);
            color: #9CAF88;
            border: 2px solid rgba(156, 175, 136, 0.3);
            padding: 14px 28px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(15px);
            box-shadow: 0 6px 20px rgba(156, 175, 136, 0.15);
            position: relative;
            overflow: hidden;
        }
        
        .action-btn.primary {
            background: linear-gradient(135deg, #9CAF88 0%, #8BA077 100%);
            color: white;
            border: none;
            padding: 18px 36px;
            font-size: 16px;
            font-weight: 700;
            box-shadow: 0 8px 25px rgba(156, 175, 136, 0.4);
        }
        
        .action-btn.primary:hover {
            background: linear-gradient(135deg, #8BA077 0%, #7A8F66 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(156, 175, 136, 0.5);
        }
        
        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(156, 175, 136, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .action-btn:hover {
            background: #9CAF88;
            color: white;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(156, 175, 136, 0.3);
            border-color: #9CAF88;
        }
        
        .action-btn:hover::before {
            left: 100%;
        }
        
        .action-btn svg {
            width: 16px;
            height: 16px;
        }
        
        .carousel-item {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            background: #f8f9fa;
            display: flex;
            justify-content: center;
        }
        
        /* Top carousel items align to bottom with padding */
        #topCarousel .carousel-item {
            align-items: flex-end;
            padding-bottom: 20px;
        }
        
        /* Bottom carousel items align to top with padding */
        #bottomCarousel .carousel-item {
            align-items: flex-start;
            padding-top: 20px;
        }
        
        .carousel-item.active {
            opacity: 1;
            transform: translateX(0);
        }
        
        .carousel-item.prev {
            transform: translateX(-100%);
        }
        
        .carousel-item img {
            width: 100%;
            height: 90%;
            object-fit: contain;
            border-radius: 0;
            transition: transform 0.3s ease;
            object-position: center;
            display: block;
            margin: 0 auto;
        }
        
        .carousel-item:hover img {
            transform: scale(1.02);
        }
        
        .item-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: white;
            padding: 1rem;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .carousel-item:hover .item-info {
            opacity: 1;
        }
        
        .item-name {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            font-size: 1.1rem;
            color: white;
            margin-bottom: 0.25rem;
            letter-spacing: 0.5px;
        }
        
        .item-price {
            color: rgba(255, 255, 255, 0.8);
            font-weight: 400;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Carousel Controls */
        .carousel-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .btn {
            background: linear-gradient(135deg, #9CAF88, #8BA077);
            color: white;
            border: none;
            padding: 0.875rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(156, 175, 136, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(156, 175, 136, 0.4);
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:active {
            transform: translateY(-1px) scale(0.98);
        }
        
        .btn-secondary {
            background: rgba(156, 175, 136, 0.08);
            color: #9CAF88;
            border: 2px solid rgba(156, 175, 136, 0.3);
            box-shadow: 0 2px 10px rgba(156, 175, 136, 0.1);
        }
        
        .btn-secondary:hover {
            background: #9CAF88;
            color: white;
            border-color: #9CAF88;
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 25px rgba(156, 175, 136, 0.3);
        }
        
        /* Main Content Row */
        .main-content-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }
        
        /* Outfit Lookbook */
        .outfit-lookbook {
            background: linear-gradient(135deg, #ffffff 0%, #fafbfc 100%);
            border-radius: 25px;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08), 0 8px 25px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.8);
            position: relative;
            overflow: hidden;
        }
        
        .outfit-lookbook::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #9CAF88, #8BA077, #9CAF88);
        }
        
        .lookbook-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
            margin-bottom: 2rem;
            letter-spacing: 0.5px;
        }
        
        .outfit-preview-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            align-items: center;
            justify-content: center;
        }
        
        .outfit-mannequin {
            width: 200px;
            height: 300px;
            position: relative;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 100px 100px 30px 30px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(156, 175, 136, 0.2);
            overflow: hidden;
            transition: all 0.4s ease;
        }
        
        .outfit-mannequin:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
        }
        
        .mannequin-top {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            height: 48%;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 20px 20px 5px 5px;
            overflow: visible;
            padding-bottom: 5px;
        }
        
        .mannequin-bottom {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            height: 48%;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 5px 5px 20px 20px;
            overflow: visible;
            padding-top: 5px;
        }
        
        .mannequin-top img,
        .mannequin-bottom img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
            transition: all 0.3s ease;
        }
        
        .mannequin-top:hover img,
        .mannequin-bottom:hover img {
            transform: scale(1.05);
        }
        
        .outfit-details {
            text-align: center;
            width: 100%;
        }
        
        .outfit-price {
            font-family: 'Inter', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: #9CAF88;
            margin-bottom: 1rem;
            text-shadow: 0 2px 4px rgba(156, 175, 136, 0.2);
        }
        
        .outfit-description {
            color: #7f8c8d;
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 2rem;
            line-height: 1.4;
        }
        
        .outfit-actions {
            display: flex;
            flex-direction: row;
            gap: 1rem;
            justify-content: center;
        }
        
        .lookbook-btn {
            padding: 0.875rem 2rem;
            border-radius: 50px;
            border: none;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            flex: 1;
            box-shadow: 0 4px 15px rgba(156, 175, 136, 0.2);
        }
        
        .lookbook-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s ease;
        }
        
        .lookbook-btn:hover::before {
            left: 100%;
        }
        
        .lookbook-btn.primary {
            background: linear-gradient(135deg, #9CAF88, #8BA077);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 175, 136, 0.3);
        }
        
        .lookbook-btn.secondary {
            background: rgba(156, 175, 136, 0.08);
            color: #9CAF88;
            border: 2px solid rgba(156, 175, 136, 0.3);
        }
        
        .lookbook-btn:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 0 12px 30px rgba(156, 175, 136, 0.4);
        }
        
        .lookbook-btn:active {
            transform: translateY(-2px) scale(1.02);
            transition: all 0.1s ease;
        }
        
        .lookbook-btn.secondary:hover {
            background: #9CAF88;
            color: white;
            border-color: #9CAF88;
        }
        
        /* AI Recommendation */
        .ai-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 25px;
            padding: 2.5rem;
            margin: 2rem 0;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(156, 175, 136, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .ai-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #9CAF88, #8BA077, #9CAF88);
        }
        
        .ai-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 0.5rem;
            text-align: center;
            font-weight: 600;
            letter-spacing: -0.5px;
        }
        
        .ai-subtitle {
            font-size: 1rem;
            color: #7f8c8d;
            text-align: center;
            margin-bottom: 2rem;
            font-weight: 400;
        }
        
        /* Chat Interface */
        .chat-container {
            height: 300px;
            overflow-y: auto;
            padding: 1rem;
            margin-bottom: 1rem;
            background: rgba(248, 249, 250, 0.5);
            border-radius: 15px;
            border: 1px solid rgba(156, 175, 136, 0.1);
        }
        
        .chat-bubble {
            margin-bottom: 1rem;
            max-width: 85%;
            animation: slideIn 0.3s ease-out;
        }
        
        .ai-bubble {
            background: linear-gradient(135deg, #9CAF88, #8BA077);
            color: white;
            padding: 1rem 1.25rem;
            border-radius: 20px 20px 20px 5px;
            margin-right: auto;
            box-shadow: 0 4px 15px rgba(156, 175, 136, 0.2);
        }
        
        .user-bubble {
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            color: #2c3e50;
            padding: 1rem 1.25rem;
            border-radius: 20px 20px 5px 20px;
            margin-left: auto;
            border: 1px solid rgba(156, 175, 136, 0.2);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .message-content {
            font-size: 0.95rem;
            line-height: 1.4;
            margin-bottom: 0.5rem;
        }
        
        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            text-align: right;
        }
        
        .chat-input-container {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }
        
        .ai-input {
            flex: 1;
            padding: 0.875rem 1.25rem;
            border: 2px solid #e8f4f8;
            border-radius: 25px;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .ai-input:focus {
            border-color: #9CAF88;
            box-shadow: 0 4px 20px rgba(156, 175, 136, 0.2);
            transform: translateY(-1px);
        }
        
        .ai-input::placeholder {
            color: #bdc3c7;
            font-style: italic;
        }
        
        .ai-suggestion-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.5);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 0.5rem;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .ai-suggestion-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
        }
        
        /* Typing Indicator */
        .typing-indicator {
            opacity: 0.8;
        }
        
        .typing-dots {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        
        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            animation: typingDot 1.4s infinite ease-in-out;
        }
        
        .typing-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .typing-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes typingDot {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
            opacity: 1;
            transform: translateY(0);
            }
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        
        /* Stats Bar */
        .stats-bar {
            background: white;
            border-radius: 15px;
            padding: 1rem 2rem;
            margin: 2rem 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            text-align: center;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #9CAF88;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.25rem;
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        
        /* Lightbox Modal */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .lightbox-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .lightbox-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            display: flex;
            gap: 2rem;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        
        .lightbox-overlay.active .lightbox-content {
            transform: scale(1);
        }
        
        .lightbox-image {
            flex: 1;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .lightbox-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .lightbox-info {
            flex: 1;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .lightbox-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }
        
        .lightbox-brand {
            color: #9CAF88;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .lightbox-price {
            font-size: 2.5rem;
            font-weight: bold;
            color: #9CAF88;
            margin-bottom: 1rem;
        }
        
        .lightbox-description {
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 2rem;
            opacity: 0.9;
        }
        
        .sizes-container {
            margin-bottom: 2rem;
        }
        
        .sizes-title {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        
        .sizes {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .size-option {
            width: 40px;
            height: 40px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .size-option:hover,
        .size-option.selected {
            border-color: #9CAF88;
            background: #9CAF88;
        }
        
        .lightbox-buttons {
            display: flex;
            gap: 1rem;
        }
        
        .lightbox-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .lightbox-btn-primary {
            background: #9CAF88;
            color: white;
        }
        
        .lightbox-btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .lightbox-btn:hover {
            transform: translateY(-2px);
        }
        
        .close-lightbox {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Quiz Styles */
        .quiz-step {
            display: none;
        }
        
        .quiz-step.active {
            display: block;
        }
        
        .quiz-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #9CAF88;
            border-radius: 10px;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        
        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .quiz-option {
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quiz-option:hover {
            border-color: #9CAF88;
            background: rgba(156, 175, 136, 0.1);
        }
        
        .quiz-option.selected {
            border-color: #9CAF88;
            background: #9CAF88;
            color: white;
        }
        
        .quiz-option img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-buttons {
                width: 100%;
                justify-content: center;
            }
            
            .carousel {
                max-width: 300px;
                height: 400px;
                margin: 0 auto;
            }
            
            .carousel-container {
                max-width: 350px;
                margin: 0 auto 2rem auto;
            }
            
            .carousel-item {
                display: flex;
                justify-content: center;
            }
            
            /* Top carousel items align to bottom on mobile */
            #topCarousel .carousel-item {
                align-items: flex-end;
                padding-bottom: 20px;
            }
            
            /* Bottom carousel items align to top on mobile */
            #bottomCarousel .carousel-item {
                align-items: flex-start;
                padding-top: 20px;
            }
            
            .carousel-item img {
                object-position: center;
                width: 100%;
                height: 90%;
                display: block;
                margin: 0 auto;
            }
            
            .main-content-row {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .outfit-preview-container {
                flex-direction: column;
                gap: 1.5rem;
            }
            
            .outfit-mannequin {
                width: 180px;
                height: 280px;
            }
            
            .outfit-details {
                width: 100%;
            }
            
            .outfit-actions {
                flex-direction: column;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .carousel-container {
                max-width: 320px;
                margin: 0 auto 2rem auto;
            }
            
            .carousel {
                max-width: 280px;
                height: 350px;
                margin: 0 auto;
            }
            
            .carousel-item {
                display: flex;
                justify-content: center;
            }
            
            /* Top carousel items align to bottom on small mobile */
            #topCarousel .carousel-item {
                align-items: flex-end;
                padding-bottom: 20px;
            }
            
            /* Bottom carousel items align to top on small mobile */
            #bottomCarousel .carousel-item {
                align-items: flex-start;
                padding-top: 20px;
            }
            
            .carousel-item img {
                object-position: center;
                display: block;
                margin: 0 auto;
                height: 90%;
            }
        }
        /* AI Recommendation Buttons */
        .ai-suggestion-btn, .ai-recommend-btn {
            background: linear-gradient(135deg, #9CAF88, #8BA077);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0.5rem 0;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .ai-suggestion-btn:hover, .ai-recommend-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(156, 175, 136, 0.4);
        }
        
        .ai-recommend-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            font-size: 1rem;
            padding: 0.75rem 1.5rem;
        }
        
        .ai-recommend-btn:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }
    </style>
</head>
<body>
    <!-- Landing Screen -->
    <div class="landing-screen" id="landingScreen">
        <div class="logo-container">
            <div class="logo-text">atyr</div>
            <div class="logo-subtitle">Fashion Mix & Match</div>
            <div class="loading-dots">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="main-app" id="mainApp">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="logo">atyr</div>
                <div class="nav-buttons">
                    <a href="style-quiz.html" class="nav-btn">
                        <span>Style Quiz</span>
                    </a>
                    <a href="moodboard.html" class="nav-btn">
                        <span>Mood Board</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Cool Intro Animation -->
        <div class="intro-animation" id="introAnimation">
            <div class="intro-content">
                <div class="intro-logo">
                    <div class="logo-text">atyr</div>
                    <div class="logo-subtitle">Fashion Intelligence</div>
                </div>
                <div class="intro-particles">
                    <div class="particle"></div>
                    <div class="particle"></div>
                    <div class="particle"></div>
                    <div class="particle"></div>
                    <div class="particle"></div>
                </div>
                <div class="intro-loading">
                    <div class="loading-bar">
                        <div class="loading-progress"></div>
                    </div>
                    <div class="loading-text">Crafting your style...</div>
                </div>
            </div>
        </div>

        <!-- Welcome Message -->
        <div class="welcome-message" id="welcomeMessage">
            Welcome back, <span id="userName">Guest</span>!
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Carousel Container -->
            <div class="carousel-container">
                <!-- Top Carousel -->
                <div class="carousel-section">
                    <div class="carousel" id="topCarousel">
                        <div class="carousel-item active" data-name="Classic White Tee" data-brand="atyr" data-price="29.99" data-description="Essential white cotton t-shirt with a relaxed fit. Perfect for layering or wearing alone. Made from 100% organic cotton for ultimate comfort." data-sizes="XS,S,M,L,XL" data-occasion="casual,everyday,weekend,summer" data-gender="unisex" data-style="casual,minimalist" onclick="openLightbox(this)">
                            <img src="images/tops/Adobe Express - file (1).png" alt="White Tee">
                            <div class="item-info">
                                <div class="item-name">Classic White Tee</div>
                                <div class="item-price">$29.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Black Sleeveless Dress" data-brand="atyr" data-price="89.99" data-description="Elegant black sleeveless dress with a modern silhouette. Perfect for evening events, dates, or sophisticated occasions. Features a flattering A-line cut and premium fabric." data-sizes="XS,S,M,L,XL" data-occasion="evening,date,formal,cocktail" data-gender="female" data-style="elegant,minimalist,formal" onclick="openLightbox(this)">
                            <img src="images/tops/Female - Black Dress, sleeveless.png" alt="Black Dress">
                            <div class="item-info">
                                <div class="item-name">Black Sleeveless Dress</div>
                                <div class="item-price">$89.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Yellow Vest" data-brand="atyr" data-price="49.99" data-description="Bright yellow sleeveless vest perfect for layering. Adds a pop of color to any outfit. Great for casual outings, festivals, or when you want to stand out." data-sizes="XS,S,M,L,XL" data-occasion="casual,festival,summer,weekend" data-gender="female" data-style="casual,colorful,trendy" onclick="openLightbox(this)">
                            <img src="images/tops/Female - Yellow Vest.png" alt="Yellow Vest">
                            <div class="item-info">
                                <div class="item-name">Yellow Vest</div>
                                <div class="item-price">$49.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Brown Casual Shirt" data-brand="atyr" data-price="42.99" data-description="Comfortable brown shirt with a relaxed fit. Perfect for casual Fridays, weekend outings, or relaxed office days. Made from breathable cotton blend." data-sizes="S,M,L,XL,XXL" data-occasion="casual,weekend,office-casual" data-gender="male" data-style="casual,relaxed,comfortable" onclick="openLightbox(this)">
                            <img src="images/tops/Male - Brown shirt.png" alt="Brown Shirt">
                            <div class="item-info">
                                <div class="item-name">Brown Casual Shirt</div>
                                <div class="item-price">$42.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Grey Loose Shirt" data-brand="atyr" data-price="38.99" data-description="Oversized grey shirt with a loose, comfortable fit. Perfect for a relaxed, effortless look. Great for casual days, lounging, or layering." data-sizes="S,M,L,XL,XXL" data-occasion="casual,lounge,weekend" data-gender="male" data-style="casual,oversized,relaxed" onclick="openLightbox(this)">
                            <img src="images/tops/Male - Grey loose shirt.png" alt="Grey Shirt">
                            <div class="item-info">
                                <div class="item-name">Grey Loose Shirt</div>
                                <div class="item-price">$38.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Black Blazer" data-brand="atyr" data-price="129.99" data-description="Classic black blazer with a tailored fit. Essential for professional settings, meetings, or smart casual occasions. Features premium wool blend fabric." data-sizes="XS,S,M,L,XL" data-occasion="office,professional,formal,meeting" data-gender="unisex" data-style="formal,professional,classic" onclick="openLightbox(this)">
                            <img src="images/tops/uni - Black blazer.png" alt="Black Blazer">
                            <div class="item-info">
                                <div class="item-name">Black Blazer</div>
                                <div class="item-price">$129.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Blue Striped T-Shirt" data-brand="atyr" data-price="34.99" data-description="Classic blue striped t-shirt with nautical vibes. Perfect for casual outings, beach days, or weekend adventures. Made from soft cotton blend." data-sizes="XS,S,M,L,XL" data-occasion="casual,weekend,beach,summer" data-gender="unisex" data-style="casual,nautical,classic" onclick="openLightbox(this)">
                            <img src="images/tops/Uni - Blue Stripped t-shirt.png" alt="Blue Striped Tee">
                            <div class="item-info">
                                <div class="item-name">Blue Striped T-Shirt</div>
                                <div class="item-price">$34.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="White Crewneck Sweater" data-brand="atyr" data-price="59.99" data-description="Cozy white crewneck sweater perfect for layering. Great for transitional weather, casual office days, or relaxed weekends. Made from soft cotton blend." data-sizes="XS,S,M,L,XL" data-occasion="casual,office-casual,weekend,fall" data-gender="unisex" data-style="casual,cozy,minimalist" onclick="openLightbox(this)">
                            <img src="images/tops/Uni - White crewneck.png" alt="White Crewneck">
                            <div class="item-info">
                                <div class="item-name">White Crewneck Sweater</div>
                                <div class="item-price">$59.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="White Long Sleeve" data-brand="atyr" data-price="32.99" data-description="Clean white long sleeve shirt with a classic fit. Perfect for layering, casual office days, or smart casual occasions. Made from breathable cotton." data-sizes="XS,S,M,L,XL" data-occasion="casual,office-casual,smart-casual" data-gender="unisex" data-style="casual,classic,minimalist" onclick="openLightbox(this)">
                            <img src="images/tops/Uni - White long sleeve.png" alt="White Long Sleeve">
                            <div class="item-info">
                                <div class="item-name">White Long Sleeve</div>
                                <div class="item-price">$32.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Elegant Blouse" data-brand="atyr" data-price="45.99" data-description="Sophisticated blouse with modern silhouette. Features premium cotton blend fabric and delicate button details. Perfect for smart casual occasions." data-sizes="XS,S,M,L,XL" data-occasion="smart-casual,office,brunch,date" data-gender="female" data-style="elegant,professional,feminine" onclick="openLightbox(this)">
                            <img src="images/tops/Remove background project (10).png" alt="Elegant Blouse">
                            <div class="item-info">
                                <div class="item-name">Elegant Blouse</div>
                                <div class="item-price">$45.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Professional Button-Up" data-brand="atyr" data-price="39.99" data-description="Crisp button-up shirt that transitions seamlessly from office to evening. Features a tailored fit and wrinkle-resistant fabric. Essential for any professional wardrobe." data-sizes="XS,S,M,L,XL" data-occasion="office,professional,meeting,formal" data-gender="unisex" data-style="professional,formal,classic" onclick="openLightbox(this)">
                            <img src="images/tops/Remove background project (11).png" alt="Button Up">
                            <div class="item-info">
                                <div class="item-name">Professional Button-Up</div>
                                <div class="item-price">$39.99</div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-controls left">
                        <button onclick="previousItem('top')"></button>
                    </div>
                    <div class="carousel-controls right">
                        <button onclick="nextItem('top')"></button>
                    </div>
                </div>

                <!-- Bottom Carousel -->
                <div class="carousel-section">
                    <div class="carousel" id="bottomCarousel">
                        <div class="carousel-item active" data-name="Classic Denim Jeans" data-brand="atyr" data-price="79.99" data-description="Timeless denim jeans with perfect fit and premium stretch. Made from high-quality denim with a comfortable waistband. Perfect for casual outings, weekends, or relaxed office days." data-sizes="28,30,32,34,36" data-occasion="casual,everyday,weekend,relaxed" data-gender="unisex" data-style="casual,classic,versatile" onclick="openLightbox(this)">
                            <img src="images/bottoms/Remove background project (1).png" alt="Denim Jeans">
                            <div class="item-info">
                                <div class="item-name">Classic Denim Jeans</div>
                                <div class="item-price">$79.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Black Soft Pants" data-brand="atyr" data-price="69.99" data-description="Comfortable black soft pants with a relaxed fit. Perfect for casual days, lounging, or relaxed office settings. Made from soft, breathable fabric that moves with you." data-sizes="XS,S,M,L,XL" data-occasion="casual,lounge,office-casual,weekend" data-gender="female" data-style="casual,comfortable,relaxed" onclick="openLightbox(this)">
                            <img src="images/bottoms/Female - Black Soft pants.png" alt="Black Soft Pants">
                            <div class="item-info">
                                <div class="item-name">Black Soft Pants</div>
                                <div class="item-price">$69.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Blue Striped Shorts" data-brand="atyr" data-price="39.99" data-description="Stylish blue striped shorts perfect for summer days, beach outings, or casual weekends. Features a comfortable fit and nautical-inspired stripes." data-sizes="XS,S,M,L,XL" data-occasion="casual,summer,beach,weekend" data-gender="female" data-style="casual,summer,nautical" onclick="openLightbox(this)">
                            <img src="images/bottoms/Female - Blue stirpped shorts.png" alt="Blue Striped Shorts">
                            <div class="item-info">
                                <div class="item-name">Blue Striped Shorts</div>
                                <div class="item-price">$39.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="White Skirt" data-brand="atyr" data-price="54.99" data-description="Elegant white skirt with a classic A-line silhouette. Perfect for office days, brunch dates, or smart casual occasions. Made from premium cotton blend." data-sizes="XS,S,M,L,XL" data-occasion="office,smart-casual,brunch,date" data-gender="female" data-style="elegant,feminine,professional" onclick="openLightbox(this)">
                            <img src="images/bottoms/Female - White skirt.png" alt="White Skirt">
                            <div class="item-info">
                                <div class="item-name">White Skirt</div>
                                <div class="item-price">$54.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Black Jeans" data-brand="atyr" data-price="84.99" data-description="Classic black jeans with a modern fit. Versatile and stylish, perfect for casual outings, weekend adventures, or relaxed office days. Made from premium denim." data-sizes="28,30,32,34,36,38" data-occasion="casual,weekend,office-casual" data-gender="male" data-style="casual,versatile,modern" onclick="openLightbox(this)">
                            <img src="images/bottoms/Male - Black Jeans.png" alt="Black Jeans">
                            <div class="item-info">
                                <div class="item-name">Black Jeans</div>
                                <div class="item-price">$84.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Blue Denim Jeans" data-brand="atyr" data-price="79.99" data-description="Classic blue denim jeans with a comfortable fit. Perfect for everyday wear, casual outings, or weekend adventures. Made from high-quality denim." data-sizes="28,30,32,34,36" data-occasion="casual,everyday,weekend" data-gender="unisex" data-style="casual,classic,versatile" onclick="openLightbox(this)">
                            <img src="images/bottoms/Uni - Blue Denim Jeans.png" alt="Blue Denim Jeans">
                            <div class="item-info">
                                <div class="item-name">Blue Denim Jeans</div>
                                <div class="item-price">$79.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Brown Pants" data-brand="atyr" data-price="65.99" data-description="Sophisticated brown pants with a tailored fit. Perfect for business casual settings, office days, or smart casual occasions. Made from premium cotton blend." data-sizes="28,30,32,34,36" data-occasion="office,business-casual,smart-casual" data-gender="unisex" data-style="professional,classic,sophisticated" onclick="openLightbox(this)">
                            <img src="images/bottoms/Uni - Brown Pants.png" alt="Brown Pants">
                            <div class="item-info">
                                <div class="item-name">Brown Pants</div>
                                <div class="item-price">$65.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Comfortable Joggers" data-brand="atyr" data-price="49.99" data-description="Ultra-comfortable joggers perfect for lounging, workouts, or casual days. Features an elastic waistband and soft, breathable fabric. Great for athleisure looks." data-sizes="XS,S,M,L,XL" data-occasion="casual,lounge,workout,athleisure" data-gender="unisex" data-style="casual,comfortable,athletic" onclick="openLightbox(this)">
                            <img src="images/bottoms/Uni - Joggers.png" alt="Joggers">
                            <div class="item-info">
                                <div class="item-name">Comfortable Joggers</div>
                                <div class="item-price">$49.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="White Trousers" data-brand="atyr" data-price="72.99" data-description="Crisp white trousers with a clean, modern silhouette. Perfect for summer office days, smart casual occasions, or when you want a fresh, polished look." data-sizes="28,30,32,34,36" data-occasion="office,smart-casual,summer,professional" data-gender="unisex" data-style="professional,clean,modern" onclick="openLightbox(this)">
                            <img src="images/bottoms/Uni - White trousers.png" alt="White Trousers">
                            <div class="item-info">
                                <div class="item-name">White Trousers</div>
                                <div class="item-price">$72.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Business Chinos" data-brand="atyr" data-price="65.99" data-description="Professional chinos that bridge the gap between casual and formal. Features a tailored fit and wrinkle-resistant fabric. Perfect for business casual settings, client meetings, or smart casual occasions." data-sizes="28,30,32,34,36" data-occasion="office,professional,business-casual,meeting" data-gender="unisex" data-style="professional,business-casual,versatile" onclick="openLightbox(this)">
                            <img src="images/bottoms/Remove background project (13).png" alt="Chinos">
                            <div class="item-info">
                                <div class="item-name">Business Chinos</div>
                                <div class="item-price">$65.99</div>
                            </div>
                        </div>
                        <div class="carousel-item" data-name="Formal Trousers" data-brand="atyr" data-price="59.99" data-description="Elegant trousers with sophisticated tailored fit. Made from premium wool blend fabric. Perfect for formal office settings, important meetings, or professional events." data-sizes="28,30,32,34,36" data-occasion="formal,office,professional,meeting,corporate" data-gender="unisex" data-style="formal,professional,elegant" onclick="openLightbox(this)">
                            <img src="images/bottoms/Remove background project (14).png" alt="Formal Pants">
                            <div class="item-info">
                                <div class="item-name">Formal Trousers</div>
                                <div class="item-price">$59.99</div>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-controls left">
                        <button onclick="previousItem('bottom')"></button>
                    </div>
                    <div class="carousel-controls right">
                        <button onclick="nextItem('bottom')"></button>
                    </div>
                </div>

                <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button class="action-btn primary" onclick="buyTogether()">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7 4V2C7 1.45 7.45 1 8 1H16C16.55 1 17 1.45 17 2V4H20C20.55 4 21 4.45 21 5S20.55 6 20 6H19V19C19 20.1 18.1 21 17 21H7C5.9 21 5 20.1 5 19V6H4C3.45 6 3 5.55 3 5S3.45 4 4 4H7ZM9 3V4H15V3H9ZM7 6V19H17V6H7Z"/>
                            </svg>
                            Buy Together
                        </button>
                        <div class="secondary-buttons">
                            <button class="action-btn" onclick="saveToBoard()">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                </svg>
                                Save to Board
                            </button>
                            <button class="action-btn" onclick="shuffleCombo()">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
                                </svg>
                                Shuffle
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Row -->
            <div class="main-content-row">
                <!-- Outfit Lookbook - Left Side -->
                <div class="outfit-lookbook">
                    <div class="lookbook-title">Your Outfit</div>
                    <div class="outfit-preview-container">
                        <div class="outfit-mannequin">
                            <div class="mannequin-top" id="mannequinTop">
                                <img id="topPreview" src="" alt="Top">
                            </div>
                            <div class="mannequin-bottom" id="mannequinBottom">
                                <img id="bottomPreview" src="" alt="Bottom">
                            </div>
                        </div>
                        <div class="outfit-details">
                            <div class="outfit-price" id="outfitPrice">$109.98</div>
                            <div class="outfit-description" id="outfitDescription">Classic White Tee + Classic Denim Jeans</div>
                            <div class="outfit-actions">
                                <button class="lookbook-btn primary" onclick="buyTogether()">Add to Cart</button>
                                <button class="lookbook-btn secondary" onclick="saveToBoard()">Save Look</button>
                            </div>
                        </div>
                    </div>
            </div>

                <!-- AI Styler - Right Side -->
            <div class="ai-section">
                    <div class="ai-title">Your Personal Styler</div>
                    <div class="ai-subtitle">Chat with your AI stylist for personalized recommendations</div>
                    
                    <!-- Chat Messages Container -->
                    <div class="chat-container" id="chatContainer">
                        <div class="ai-message chat-bubble ai-bubble">
                            <div class="message-content">
                                 Hi! I'm your personal stylist. Tell me where you're heading and I'll help you find the perfect outfit!
                </div>
                            <div class="message-time">Just now</div>
                        </div>
                    </div>
                    
                    <!-- Chat Input -->
                    <div class="chat-input-container">
                        <input type="text" class="ai-input" id="aiInput" placeholder="Where are you heading? (e.g., office meeting, date night, party)">
                        <button class="btn" onclick="sendMessage()">Send</button>
                    </div>
                </div>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-number" id="fitsMade">0</div>
                    <div class="stat-label">Fits Made</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="timeSpent">0</div>
                    <div class="stat-label">Minutes Spent</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="combosSaved">0</div>
                    <div class="stat-label">Combos Saved</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Modal -->
    <div class="modal-overlay" id="quizModal">
        <div class="modal-content">
            <h2 style="text-align: center; margin-bottom: 2rem; color: #9CAF88; font-size: 2rem;">Style Quiz</h2>
            
            <!-- Quiz Step 1: Name -->
            <div class="quiz-step active" id="quizStep1">
                <h3>What's your name?</h3>
                <input type="text" id="quizName" class="quiz-input" placeholder="Enter your name">
                <button class="btn" onclick="nextQuizStep()">Next</button>
            </div>
            
            <!-- Quiz Step 2: Gender -->
            <div class="quiz-step" id="quizStep2" style="display: none;">
                <h3>How do you identify?</h3>
                <div class="quiz-options">
                    <div class="quiz-option" onclick="selectGender('male')">Male</div>
                    <div class="quiz-option" onclick="selectGender('female')">Female</div>
                    <div class="quiz-option" onclick="selectGender('other')">Other</div>
                </div>
                <button class="btn" onclick="nextQuizStep()" id="quizNext2" disabled>Next</button>
            </div>
            
            <!-- Quiz Step 3: Style Selection -->
            <div class="quiz-step" id="quizStep3" style="display: none;">
                <h3>Select 5-10 styles you love:</h3>
                <div class="quiz-options" id="styleOptions">
                    <div class="quiz-option" onclick="toggleStyle('casual')">
                        <img src="https://via.placeholder.com/150x100/ff6b6b/ffffff?text=Casual" alt="Casual">
                        <div>Casual</div>
                    </div>
                    <div class="quiz-option" onclick="toggleStyle('formal')">
                        <img src="https://via.placeholder.com/150x100/4ecdc4/ffffff?text=Formal" alt="Formal">
                        <div>Formal</div>
                    </div>
                    <div class="quiz-option" onclick="toggleStyle('streetwear')">
                        <img src="https://via.placeholder.com/150x100/45b7d1/ffffff?text=Streetwear" alt="Streetwear">
                        <div>Streetwear</div>
                    </div>
                    <div class="quiz-option" onclick="toggleStyle('bohemian')">
                        <img src="https://via.placeholder.com/150x100/f9ca24/ffffff?text=Bohemian" alt="Bohemian">
                        <div>Bohemian</div>
                    </div>
                    <div class="quiz-option" onclick="toggleStyle('minimalist')">
                        <img src="https://via.placeholder.com/150x100/6c5ce7/ffffff?text=Minimalist" alt="Minimalist">
                        <div>Minimalist</div>
                    </div>
                    <div class="quiz-option" onclick="toggleStyle('vintage')">
                        <img src="https://via.placeholder.com/150x100/a55eea/ffffff?text=Vintage" alt="Vintage">
                        <div>Vintage</div>
                    </div>
                </div>
                <button class="btn" onclick="nextQuizStep()" id="quizNext3" disabled>Next</button>
            </div>
            
            <!-- Quiz Step 4: Results -->
            <div class="quiz-step" id="quizStep4" style="display: none;">
                <h3>Welcome to atyr, <span id="quizResultName"></span>!</h3>
                <p>Your style preferences have been saved. Let's start mixing & matching!</p>
                <button class="btn" onclick="completeQuiz()">Start Mixing & Matching</button>
            </div>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="lightbox-overlay" id="lightboxOverlay">
        <div class="lightbox-content">
            <button class="close-lightbox" onclick="closeLightbox()">&times;</button>
            <div class="lightbox-image">
                <img id="lightboxImage" src="" alt="">
            </div>
            <div class="lightbox-info">
                <div class="lightbox-title" id="lightboxTitle"></div>
                <div class="lightbox-brand" id="lightboxBrand"></div>
                <div class="lightbox-price" id="lightboxPrice"></div>
                <div class="lightbox-description" id="lightboxDescription"></div>
                <div class="sizes-container">
                    <div class="sizes-title">Select Size:</div>
                    <div class="sizes" id="lightboxSizes"></div>
                </div>
                <div class="lightbox-buttons">
                    <button class="lightbox-btn lightbox-btn-primary" onclick="addToCart()">Add to Cart</button>
                    <button class="lightbox-btn lightbox-btn-secondary" onclick="closeLightbox()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let currentTopIndex = 0;
        let currentBottomIndex = 0;
        let currentQuizStep = 1;
        let quizData = {
            name: '',
            gender: '',
            selectedStyles: []
        };
        let stats = {
            fitsMade: 0,
            timeSpent: 0,
            combosSaved: 0
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            // Check if returning from moodboard (no intro animation)
            const urlParams = new URLSearchParams(window.location.search);
            const skipIntro = urlParams.get('skipIntro') === 'true';
            
            if (skipIntro) {
                // Skip intro animation and go straight to main app
                document.getElementById('landingScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.add('active');
                initializeApp();
            } else {
            // Show landing screen for 3 seconds
            setTimeout(() => {
                document.getElementById('landingScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.add('active');
                    initializeApp();
                }, 3000);
            }
        });
                
        function initializeApp() {
                // Check for saved user data
                const savedProfile = localStorage.getItem('userProfile');
                if (savedProfile) {
                    const profile = JSON.parse(savedProfile);
                    document.getElementById('userName').textContent = profile.name;
                
                // Load user profile into AI
                userProfile.name = profile.name;
                userProfile.gender = profile.gender;
                userProfile.style = profile.selectedStyles ? profile.selectedStyles.join(', ') : '';
                
                // Add personalized welcome message
                addMessageToChat(`Welcome back, ${profile.name}! I remember you're into ${profile.selectedStyles ? profile.selectedStyles.join(', ') : 'fashion'} styles. What can I help you with today?`, 'ai');
                }
                
                // Load saved stats
                const savedStats = localStorage.getItem('userStats');
                if (savedStats) {
                    stats = JSON.parse(savedStats);
                    updateStats();
                }
                
                // Start timer
                setInterval(() => {
                    stats.timeSpent++;
                    updateStats();
                    localStorage.setItem('userStats', JSON.stringify(stats));
                }, 60000); // Every minute
        }

        // Carousel Functions
        function nextItem(type) {
            if (type === 'top') {
                const items = document.querySelectorAll('#topCarousel .carousel-item');
                const currentItem = items[currentTopIndex];
                currentItem.classList.remove('active');
                currentItem.classList.add('prev');
                
                currentTopIndex = (currentTopIndex + 1) % items.length;
                const nextItem = items[currentTopIndex];
                nextItem.classList.add('active');
                nextItem.classList.remove('prev');
                
                // Clean up prev class after animation
                setTimeout(() => {
                    currentItem.classList.remove('prev');
                }, 600);
            } else {
                const items = document.querySelectorAll('#bottomCarousel .carousel-item');
                const currentItem = items[currentBottomIndex];
                currentItem.classList.remove('active');
                currentItem.classList.add('prev');
                
                currentBottomIndex = (currentBottomIndex + 1) % items.length;
                const nextItem = items[currentBottomIndex];
                nextItem.classList.add('active');
                nextItem.classList.remove('prev');
                
                // Clean up prev class after animation
                setTimeout(() => {
                    currentItem.classList.remove('prev');
                }, 600);
            }
            updateComboDisplay();
        }

        function previousItem(type) {
            if (type === 'top') {
                const items = document.querySelectorAll('#topCarousel .carousel-item');
                const currentItem = items[currentTopIndex];
                currentItem.classList.remove('active');
                currentItem.classList.add('prev');
                
                currentTopIndex = currentTopIndex === 0 ? items.length - 1 : currentTopIndex - 1;
                const prevItem = items[currentTopIndex];
                prevItem.classList.add('active');
                prevItem.classList.remove('prev');
                
                // Clean up prev class after animation
                setTimeout(() => {
                    currentItem.classList.remove('prev');
                }, 600);
            } else {
                const items = document.querySelectorAll('#bottomCarousel .carousel-item');
                const currentItem = items[currentBottomIndex];
                currentItem.classList.remove('active');
                currentItem.classList.add('prev');
                
                currentBottomIndex = currentBottomIndex === 0 ? items.length - 1 : currentBottomIndex - 1;
                const prevItem = items[currentBottomIndex];
                prevItem.classList.add('active');
                prevItem.classList.remove('prev');
                
                // Clean up prev class after animation
                setTimeout(() => {
                    currentItem.classList.remove('prev');
                }, 600);
            }
            updateComboDisplay();
        }

        function updateComboDisplay() {
            const topItem = document.querySelectorAll('#topCarousel .carousel-item')[currentTopIndex];
            const bottomItem = document.querySelectorAll('#bottomCarousel .carousel-item')[currentBottomIndex];
            
            const topPrice = parseFloat(topItem.dataset.price);
            const bottomPrice = parseFloat(bottomItem.dataset.price);
            const totalPrice = topPrice + bottomPrice;
            
            // Update outfit lookbook
            document.getElementById('outfitPrice').textContent = `$${totalPrice.toFixed(2)}`;
            document.getElementById('outfitDescription').textContent = 
                `${topItem.dataset.name} + ${bottomItem.dataset.name}`;
            
            // Update mannequin with actual clothing images
            updateMannequin(topItem, bottomItem);
        }
        
        function updateMannequin(topItem, bottomItem) {
            const topPreview = document.getElementById('topPreview');
            const bottomPreview = document.getElementById('bottomPreview');
            
            // Get the actual clothing images
            const topImage = topItem.querySelector('img').src;
            const bottomImage = bottomItem.querySelector('img').src;
            
            // Update mannequin images
            topPreview.src = topImage;
            bottomPreview.src = bottomImage;
            
            // Add fade-in effect
            topPreview.style.opacity = '0';
            bottomPreview.style.opacity = '0';
            
            setTimeout(() => {
                topPreview.style.opacity = '1';
                bottomPreview.style.opacity = '1';
            }, 100);
        }

        function buyTogether() {
            stats.fitsMade++;
            updateStats();
            localStorage.setItem('userStats', JSON.stringify(stats));
            
            const topItem = document.querySelectorAll('#topCarousel .carousel-item')[currentTopIndex];
            const bottomItem = document.querySelectorAll('#bottomCarousel .carousel-item')[currentBottomIndex];
            
            alert(`Added to cart: ${topItem.dataset.name} + ${bottomItem.dataset.name} = $${(parseFloat(topItem.dataset.price) + parseFloat(bottomItem.dataset.price)).toFixed(2)}`);
        }
        
        function saveToBoard() {
            const topItem = document.querySelectorAll('#topCarousel .carousel-item')[currentTopIndex];
            const bottomItem = document.querySelectorAll('#bottomCarousel .carousel-item')[currentBottomIndex];
            
            const combo = {
                id: Date.now(),
                top: {
                    name: topItem.dataset.name,
                    price: topItem.dataset.price,
                    image: topItem.querySelector('img').src
                },
                bottom: {
                    name: bottomItem.dataset.name,
                    price: bottomItem.dataset.price,
                    image: bottomItem.querySelector('img').src
                },
                total: (parseFloat(topItem.dataset.price) + parseFloat(bottomItem.dataset.price)).toFixed(2),
                savedAt: new Date().toLocaleDateString()
            };
            
            // Save to localStorage
            let savedCombos = JSON.parse(localStorage.getItem('savedCombos') || '[]');
            savedCombos.push(combo);
            localStorage.setItem('savedCombos', JSON.stringify(savedCombos));
            
            // Show success message
            const btn = event.target.closest('.action-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Saved!';
            btn.style.background = '#9CAF88';
            btn.style.color = 'white';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = '';
                btn.style.color = '';
            }, 2000);
        }
        
        function shuffleCombo() {
            const topCarousel = document.getElementById('topCarousel');
            const bottomCarousel = document.getElementById('bottomCarousel');
            
            // Get all items
            const topItems = Array.from(topCarousel.querySelectorAll('.carousel-item'));
            const bottomItems = Array.from(bottomCarousel.querySelectorAll('.carousel-item'));
            
            // Randomly select items
            const randomTopIndex = Math.floor(Math.random() * topItems.length);
            const randomBottomIndex = Math.floor(Math.random() * bottomItems.length);
            
            // Animate out current items
            const currentTopItem = topItems[currentTopIndex];
            const currentBottomItem = bottomItems[currentBottomIndex];
            
            currentTopItem.classList.remove('active');
            currentTopItem.classList.add('prev');
            currentBottomItem.classList.remove('active');
            currentBottomItem.classList.add('prev');
            
            // Update current indices
            currentTopIndex = randomTopIndex;
            currentBottomIndex = randomBottomIndex;
            
            // Animate in new items
            setTimeout(() => {
                topItems[currentTopIndex].classList.add('active');
                topItems[currentTopIndex].classList.remove('prev');
                bottomItems[currentBottomIndex].classList.add('active');
                bottomItems[currentBottomIndex].classList.remove('prev');
                
                // Clean up prev classes
                currentTopItem.classList.remove('prev');
                currentBottomItem.classList.remove('prev');
            }, 100);
            
            // Update combo display
            updateComboDisplay();
            
            // Show shuffle animation
            const btn = event.target.closest('.action-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/></svg>Shuffled!';
            btn.style.background = '#9CAF88';
            btn.style.color = 'white';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = '';
                btn.style.color = '';
            }, 1500);
        }

        // Chat Functions
        let chatHistory = [];
        let userProfile = {
            name: '',
            style: '',
            preferences: [],
            occasions: [],
            lastOutfit: ''
        };
        
        function sendMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            if (!message) return;
            
            // Add user message to chat
            addMessageToChat(message, 'user');
            
            // Learn about user
            learnAboutUser(message);
            
            // Clear input
            input.value = '';
            
            // Get AI response
            setTimeout(() => {
                const aiResponse = getAIResponse(message);
                addMessageToChat(aiResponse, 'ai');
            }, 1000);
        }
        
        function learnAboutUser(message) {
            const messageLower = message.toLowerCase();
            
            // Learn name
            if (messageLower.includes('my name is') || messageLower.includes('i\'m ') || messageLower.includes('i am ')) {
                const nameMatch = message.match(/(?:my name is|i'm|i am)\s+([a-zA-Z]+)/i);
                if (nameMatch) {
                    userProfile.name = nameMatch[1];
                }
            }
            
            // Learn style preferences
            if (messageLower.includes('like') || messageLower.includes('prefer') || messageLower.includes('love')) {
                if (messageLower.includes('casual')) userProfile.preferences.push('casual');
                if (messageLower.includes('formal')) userProfile.preferences.push('formal');
                if (messageLower.includes('elegant')) userProfile.preferences.push('elegant');
                if (messageLower.includes('comfortable')) userProfile.preferences.push('comfortable');
            }
            
            // Learn occasions
            if (messageLower.includes('office') || messageLower.includes('work')) userProfile.occasions.push('office');
            if (messageLower.includes('date') || messageLower.includes('romantic')) userProfile.occasions.push('date');
            if (messageLower.includes('party') || messageLower.includes('celebration')) userProfile.occasions.push('party');
            if (messageLower.includes('casual') || messageLower.includes('weekend')) userProfile.occasions.push('casual');
        }
        
        function addMessageToChat(content, sender) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-bubble ${sender}-bubble`;
            
            const time = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            
            messageDiv.innerHTML = `
                <div class="message-content">${content}</div>
                <div class="message-time">${time}</div>
            `;
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Store in history
            chatHistory.push({ content, sender, time });
        }
        
        async function getAIResponse(message) {
            const currentTop = document.querySelectorAll('#topCarousel .carousel-item')[currentTopIndex];
            const currentBottom = document.querySelectorAll('#bottomCarousel .carousel-item')[currentBottomIndex];
            
            const currentTopName = currentTop.dataset.name;
            const currentBottomName = currentBottom.dataset.name;
            
            // Use real Groq API for intelligent responses
            return await getGroqAIResponse(message, currentTopName, currentBottomName);
        }
        
        async function getGroqAIResponse(message, currentTop, currentBottom) {
            try {
                // Groq API configuration
                const GROQ_API_KEY = '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'; // Replace with your actual Groq API key
                const GROQ_API_URL = 'https://api.groq.com/openai/v1/chat/completions';
                
                const systemPrompt = `You are a friendly, knowledgeable fashion stylist and personal shopper. You help users find the perfect outfits for any occasion. 

Current outfit context:
- Top: ${currentTop}
- Bottom: ${currentBottom}

User profile: ${userProfile.name ? `Name: ${userProfile.name}` : 'Guest user'}
Style preferences: ${userProfile.style ? userProfile.style.join(', ') : 'Not specified'}
Occasions: ${userProfile.occasions ? userProfile.occasions.join(', ') : 'Not specified'}

Guidelines:
- Be conversational and friendly, like talking to a friend
- Give specific, actionable fashion advice
- Consider the current outfit they have selected
- Ask follow-up questions when helpful
- Be encouraging and positive
- Keep responses concise but helpful
- Use emojis occasionally but not excessively

Available clothing items:
Tops: Classic White Tee, Black Sleeveless Dress, Yellow Vest, Brown Casual Shirt, Grey Loose Shirt, Black Blazer, Blue Striped T-Shirt, White Crewneck Sweater, White Long Sleeve, Elegant Blouse, Professional Button-Up
Bottoms: Classic Denim Jeans, Black Soft Pants, Blue Striped Shorts, White Skirt, Black Jeans, Blue Denim Jeans, Brown Pants, Comfortable Joggers, White Trousers, Business Chinos, Formal Trousers`;

                const response = await fetch(GROQ_API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GROQ_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'llama-3.1-8b-instant',
                        messages: [
                            { role: 'system', content: systemPrompt },
                            { role: 'user', content: message }
                        ],
                        max_tokens: 300,
                        temperature: 0.7,
                        stream: false
                    })
                });

                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status}`);
                }

                const data = await response.json();
                return data.choices[0].message.content;

            } catch (error) {
                console.error('Groq API Error:', error);
                // Fallback to local response if API fails
                return getFallbackResponse(message, currentTop, currentBottom);
            }
        }
        
        function getFallbackResponse(message, currentTop, currentBottom) {
            // Simple fallback responses when API is not available
            const messageLower = message.toLowerCase();
            
            if (messageLower.includes('hello') || messageLower.includes('hi') || messageLower.includes('hey')) {
                return `Hey!  I'm your AI stylist! I can help you find the perfect outfit for any occasion. What are you looking for today?`;
            }
            
            if (messageLower.includes('date') || messageLower.includes('romantic')) {
                return `For a date night, I'd recommend something elegant yet comfortable. Your current ${currentTop} + ${currentBottom} combo could work! Want me to suggest some alternatives?`;
            }
            
            if (messageLower.includes('work') || messageLower.includes('office') || messageLower.includes('meeting')) {
                return `For work, you want something professional and polished. Your ${currentTop} + ${currentBottom} combo looks great! Need any adjustments?`;
            }
            
            return `I'd love to help you with fashion advice! Tell me more about what you're looking for - I can suggest outfits for any occasion! `;
        }
        
        function generateIntelligentResponse(message, currentTop, currentBottom) {
            const messageLower = message.toLowerCase();
            
            // Analyze the message intent and content
            const intent = analyzeMessageIntent(message);
            const context = getConversationContext();
            
            // Generate contextual response
            return createContextualResponse(intent, context, message, currentTop, currentBottom);
        }
        
        function analyzeMessageIntent(message) {
            const messageLower = message.toLowerCase();
            
            // Complex context analysis - look for multiple keywords together
            const context = analyzeComplexContext(messageLower);
            if (context.confidence > 0.7) {
                return context;
            }
            
            // Greeting patterns
            if (messageLower.match(/\b(hi|hello|hey|yo|what's up|how are you|good morning|good afternoon|good evening)\b/)) {
                return { type: 'greeting', confidence: 0.9 };
            }
            
            // Question patterns
            if (messageLower.includes('?') || messageLower.match(/\b(what|how|where|when|why|which|who)\b/)) {
                return { type: 'question', confidence: 0.8 };
            }
            
            // Request patterns
            if (messageLower.match(/\b(need|want|looking for|help me|can you|could you|please)\b/)) {
                return { type: 'request', confidence: 0.8 };
            }
            
            // Feedback patterns
            if (messageLower.match(/\b(no|not|too|bad|wrong|doesn't|don't|hate|dislike)\b/)) {
                return { type: 'feedback', confidence: 0.7 };
            }
            
            // Occasion patterns
            const occasions = ['office', 'work', 'meeting', 'date', 'party', 'casual', 'weekend', 'sleepover', 'sleep over', 'night', 'concert', 'formal', 'wedding', 'interview'];
            for (const occasion of occasions) {
                if (messageLower.includes(occasion)) {
                    return { type: 'occasion', occasion: occasion, confidence: 0.8 };
                }
            }
            
            // Item patterns
            const items = ['jeans', 'tee', 'shirt', 'dress', 'blazer', 'sweater', 'pants', 'skirt', 'shorts', 'jacket', 'top', 'bottom'];
            for (const item of items) {
                if (messageLower.includes(item)) {
                    return { type: 'item', item: item, confidence: 0.7 };
                }
            }
            
            // Default to general conversation
            return { type: 'conversation', confidence: 0.5 };
        }
        
        function analyzeComplexContext(messageLower) {
            // Cruise + Pool context
            if ((messageLower.includes('cruise') || messageLower.includes('boat') || messageLower.includes('ship')) && 
                (messageLower.includes('pool') || messageLower.includes('swim') || messageLower.includes('beach'))) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'cruise_pool', 
                    context: 'cruise pool side',
                    confidence: 0.9 
                };
            }
            
            // Beach + Vacation context
            if ((messageLower.includes('beach') || messageLower.includes('vacation') || messageLower.includes('trip')) && 
                (messageLower.includes('swim') || messageLower.includes('pool') || messageLower.includes('water'))) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'beach_vacation', 
                    context: 'beach vacation',
                    confidence: 0.9 
                };
            }
            
            // Wedding + Reception context
            if (messageLower.includes('wedding') && (messageLower.includes('reception') || messageLower.includes('party') || messageLower.includes('dance'))) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'wedding_reception', 
                    context: 'wedding reception',
                    confidence: 0.9 
                };
            }
            
            // Business + Travel context
            if ((messageLower.includes('business') || messageLower.includes('work')) && 
                (messageLower.includes('travel') || messageLower.includes('trip') || messageLower.includes('flight'))) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'business_travel', 
                    context: 'business travel',
                    confidence: 0.9 
                };
            }
            
            // Date + Dinner context
            if (messageLower.includes('date') && (messageLower.includes('dinner') || messageLower.includes('restaurant') || messageLower.includes('romantic'))) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'date_dinner', 
                    context: 'romantic dinner',
                    confidence: 0.9 
                };
            }
            
            // Single occasion with specific context
            if (messageLower.includes('cruise')) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'cruise', 
                    context: 'cruise',
                    confidence: 0.8 
                };
            }
            
            if (messageLower.includes('pool') || messageLower.includes('swim')) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'pool', 
                    context: 'pool/swimming',
                    confidence: 0.8 
                };
            }
            
            if (messageLower.includes('beach')) {
                return { 
                    type: 'complex_occasion', 
                    occasion: 'beach', 
                    context: 'beach',
                    confidence: 0.8 
                };
            }
            
            return { type: 'none', confidence: 0 };
        }
        
        function getConversationContext() {
            // Get recent conversation history for context
            const recentMessages = chatHistory.slice(-3); // Last 3 messages
            return {
                recentMessages: recentMessages,
                userProfile: userProfile,
                currentTime: new Date().getHours()
            };
        }
        
        function createContextualResponse(intent, context, message, currentTop, currentBottom) {
            const messageLower = message.toLowerCase();
            
            switch (intent.type) {
                case 'greeting':
                    return generateGreetingResponse(context, currentTop, currentBottom);
                    
                case 'question':
                    return generateQuestionResponse(message, context, currentTop, currentBottom);
                    
                case 'request':
                    return generateRequestResponse(message, context, currentTop, currentBottom);
                    
                case 'feedback':
                    return generateFeedbackResponse(message, context, currentTop, currentBottom);
                    
                case 'occasion':
                    return generateOccasionResponse(intent.occasion, context, currentTop, currentBottom);
                    
                case 'complex_occasion':
                    return generateComplexOccasionResponse(intent, context, currentTop, currentBottom);
                    
                case 'item':
                    return generateItemResponse(intent.item, message, context, currentTop, currentBottom);
                    
                default:
                    return generateConversationalResponse(message, context, currentTop, currentBottom);
            }
        }
        
        function generateGreetingResponse(context, currentTop, currentBottom) {
            const greetings = [
                `Hey!  ${context.userProfile.name ? `What's up ${context.userProfile.name}!` : 'How\'s it going?'} I see you've got ${currentTop} + ${currentBottom} selected. What's up?`,
                `Yo! ${context.userProfile.name ? `Hey ${context.userProfile.name}!` : 'What\'s good?'} Your ${currentTop} + ${currentBottom} looks nice. What's going on?`,
                `Hey! ${context.userProfile.name ? `Good to see you ${context.userProfile.name}!` : 'How are you doing?'} I see your ${currentTop} + ${currentBottom} combo. What's happening?`
            ];
            return greetings[Math.floor(Math.random() * greetings.length)];
        }
        
        function generateQuestionResponse(message, context, currentTop, currentBottom) {
            const messageLower = message.toLowerCase();
            
            // Fashion-related questions
            if (messageLower.includes('what') && (messageLower.includes('wear') || messageLower.includes('outfit') || messageLower.includes('look'))) {
                return `What kind of look are you going for? ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}I can help you find something that works for any occasion!`;
            }
            
            if (messageLower.includes('how') && messageLower.includes('look')) {
                return `You look great! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}Your ${currentTop} + ${currentBottom} combo is solid. What's the occasion?`;
            }
            
            // General questions
            return `Good question! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What do you need help with? I'm here to help with outfit stuff!`;
        }
        
        function generateRequestResponse(message, context, currentTop, currentBottom) {
            const messageLower = message.toLowerCase();
            
            if (messageLower.includes('need') || messageLower.includes('want')) {
                return `Got it! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What do you need help with? I can suggest some great outfit combinations!`;
            }
            
            if (messageLower.includes('help')) {
                return `I'm here to help! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What do you need? Outfit suggestions? Style advice? Just ask!`;
            }
            
            return `Sure thing! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What can I do for you?`;
        }
        
        function generateFeedbackResponse(message, context, currentTop, currentBottom) {
            const messageLower = message.toLowerCase();
            
            if (messageLower.includes('too formal') || messageLower.includes('too fancy')) {
                return `Oh totally! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You're right, that was way too formal. You want something more casual and relaxed!`;
            }
            
            if (messageLower.includes('not good') || messageLower.includes('doesn\'t work')) {
                return `Got it! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What kind of vibe are you going for instead?`;
            }
            
            return `Ah okay! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What would work better for you?`;
        }
        
        function generateOccasionResponse(occasion, context, currentTop, currentBottom) {
            const occasionLower = occasion.toLowerCase();
            
            if (occasionLower.includes('sleepover') || occasionLower.includes('sleep')) {
                return `For a sleepover you definitely want something comfy! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}Try something like a white tee with joggers or a cozy sweater with jeans. Nothing too fancy, just something you can relax in!`;
            }
            
            if (occasionLower.includes('office') || occasionLower.includes('work')) {
                return `For the office, you want something professional but not stuffy. ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}A nice button-up with chinos or a blouse with trousers would work great!`;
            }
            
            if (occasionLower.includes('date')) {
                return `For a date, you want to look good but not overdone. ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}Something like a nice blouse with jeans or a dress would be perfect!`;
            }
            
            return `For ${occasion}, you want something that fits the vibe! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What kind of look are you thinking?`;
        }
        
        function generateComplexOccasionResponse(intent, context, currentTop, currentBottom) {
            const occasion = intent.occasion;
            const occasionContext = intent.context;
            
            switch (occasion) {
                case 'cruise_pool':
                    return `Perfect! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}For a cruise pool side, you want something stylish but practical. Think flowy cover-ups, cute swimwear, and easy-to-wear pieces that can go from pool to deck. A nice sundress or linen shorts with a breezy top would be ideal!`;
                    
                case 'cruise':
                    return `Cruise vibes! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You'll want versatile pieces that work for different activities - pool, dining, exploring ports. Think lightweight fabrics, layers you can add/remove, and colors that work in the sun. What's your main focus - pool time, dining, or exploring?`;
                    
                case 'pool':
                case 'beach_vacation':
                    return `Pool/beach time! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You want something that's comfortable, dries quickly, and looks great. Think breathable fabrics, easy-care pieces, and colors that pop against water. A cute cover-up or quick-dry shorts with a tank would be perfect!`;
                    
                case 'beach':
                    return `Beach day! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You want something that's sand-friendly, sun-protective, and easy to move in. Think lightweight, breathable fabrics and pieces that won't get ruined by salt water or sand.`;
                    
                case 'wedding_reception':
                    return `Wedding reception! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You want something elegant but dance-friendly. Think sophisticated pieces that move well, comfortable shoes, and layers for temperature changes. A nice dress or dressy separates would work great!`;
                    
                case 'business_travel':
                    return `Business travel! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You need versatile pieces that work for meetings, travel, and downtime. Think wrinkle-resistant fabrics, mix-and-match separates, and comfortable layers for different climates.`;
                    
                case 'date_dinner':
                    return `Romantic dinner! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}You want something that's elegant but not overdressed. Think sophisticated pieces that make you feel confident - a nice dress or dressy separates with some personality.`;
                    
                default:
                    return `That sounds like a great occasion! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What kind of vibe are you going for? I can help you find the perfect outfit!`;
            }
        }
        
        function generateItemResponse(item, message, context, currentTop, currentBottom) {
            const itemLower = item.toLowerCase();
            
            if (itemLower.includes('jeans')) {
                return `Jeans are super versatile! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}They go great with tees, sweaters, blouses, or even blazers. What kind of look are you going for?`;
            }
            
            if (itemLower.includes('tee') || itemLower.includes('shirt')) {
                return `Tees and shirts are wardrobe staples! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}They work with jeans, skirts, shorts, or pants. Super versatile!`;
            }
            
            return `That's a great piece! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What kind of look are you going for? I can help you find the perfect pairing!`;
        }
        
        function generateConversationalResponse(message, context, currentTop, currentBottom) {
            const responses = [
                `Interesting! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What's on your mind?`,
                `Cool! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What do you need help with?`,
                `Nice! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}Anything I can help you with?`,
                `Got it! ${context.userProfile.name ? `Hey ${context.userProfile.name}, ` : ''}What's going on?`
            ];
            return responses[Math.floor(Math.random() * responses.length)];
        }
        
        function getHelpResponse() {
            return `Hey! ${userProfile.name ? `What's up ${userProfile.name}! ` : ''}I'm here to help with outfit stuff if you need it. What's going on?`;
        }
        
        function getThanksResponse() {
            const thanks = [
                `No problem!  ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}I got you!`,
                `You're good!  ${userProfile.name ? `That's what I'm here for ${userProfile.name}!` : 'That\'s what I\'m here for!'}`,
                `Anytime!  ${userProfile.name ? `Always here to help ${userProfile.name}!` : 'Always here to help!'}`
            ];
            return thanks[Math.floor(Math.random() * thanks.length)];
        }
        
        function getOfficeResponse(currentTop, currentBottom) {
            const professional = ['Professional Button-Up', 'Business Chinos', 'Formal Trousers'];
            const isProfessional = professional.some(item => currentTop.includes(item) || currentBottom.includes(item));
            
            // Check if user prefers formal style from quiz
            const prefersFormal = userProfile.style && userProfile.style.includes('formal');
            const prefersCasual = userProfile.style && userProfile.style.includes('casual');
            
            if (isProfessional) {
                return `Perfect choice! ${userProfile.name ? `${userProfile.name}, ` : ''}Your ${currentTop} and ${currentBottom} combo is office-ready. ${prefersFormal ? 'I can see you love formal styles - this is perfect for you!' : 'You\'ll look professional and confident!'} `;
            } else {
                const recommendation = prefersCasual ? 
                    `For the office, ${userProfile.name ? `${userProfile.name}, ` : ''}I know you prefer casual styles, but let's find something that works for work: <br><br> <strong>Professional Button-Up + Business Chinos</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Business Chinos')">Preview This Look</button><br><br> <strong>Elegant Blouse + Formal Trousers</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Formal Trousers')">Preview This Look</button>` :
                    `For the office, ${userProfile.name ? `${userProfile.name}, ` : ''}I recommend: <br><br> <strong>Professional Button-Up + Business Chinos</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Business Chinos')">Preview This Look</button><br><br> <strong>Elegant Blouse + Formal Trousers</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Formal Trousers')">Preview This Look</button>`;
                
                return recommendation;
            }
        }
        
        function getMeetingResponse(currentTop, currentBottom) {
            const formal = ['Professional Button-Up', 'Elegant Blouse', 'Formal Trousers'];
            const isFormal = formal.some(item => currentTop.includes(item) || currentBottom.includes(item));
            
            if (isFormal) {
                return `Excellent choice! Your ${currentTop} and ${currentBottom} will make a great impression in that meeting. You've got this! `;
            } else {
                return `For an important meeting, I recommend: <br><br> <strong>Professional Button-Up + Formal Trousers</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Formal Trousers')">Preview This Look</button><br><br> <strong>Elegant Blouse + Business Chinos</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Business Chinos')">Preview This Look</button>`;
            }
        }
        
        function getDateResponse(currentTop, currentBottom) {
            const romantic = ['Elegant Blouse', 'Professional Button-Up', 'Black Sleeveless Dress'];
            const isRomantic = romantic.some(item => currentTop.includes(item));
            
            if (isRomantic) {
                return `Lovely choice! The ${currentTop} is perfect for a date - sophisticated yet approachable. Have a wonderful time! <br><br><button class="ai-recommend-btn" onclick="showRecommendedFit('${currentTop}', '${currentBottom}')"> Show This Recommended Fit</button>`;
            } else {
                return `For a date night, I recommend: <br><br> <strong>Black Sleeveless Dress + White Skirt</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Black Sleeveless Dress', 'White Skirt')">Preview This Look</button><br><br> <strong>Elegant Blouse + Business Chinos</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Business Chinos')">Preview This Look</button><br><br> <strong>Professional Button-Up + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Classic Denim Jeans')">Preview This Look</button>`;
            }
        }
        
        function getPartyResponse(currentTop, currentBottom) {
            const party = ['Elegant Blouse', 'Professional Button-Up'];
            const isParty = party.some(item => currentTop.includes(item));
            
            if (isParty) {
                return `Party ready! Your ${currentTop} and ${currentBottom} combo will turn heads! Let's celebrate! `;
            } else {
                return `Time to party! I recommend: <br><br> <strong>Elegant Blouse + Business Chinos</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Business Chinos')">Preview This Look</button><br><br> <strong>Professional Button-Up + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Classic Denim Jeans')">Preview This Look</button>`;
            }
        }
        
        function getCasualResponse(currentTop, currentBottom) {
            const casual = ['Classic White Tee', 'Classic Denim Jeans'];
            const isCasual = casual.some(item => currentTop.includes(item) || currentBottom.includes(item));
            
            // Check if user prefers casual style from quiz
            const prefersCasual = userProfile.style && userProfile.style.includes('casual');
            const prefersMinimalist = userProfile.style && userProfile.style.includes('minimalist');
            
            if (isCasual) {
                return `Perfect casual vibes! ${userProfile.name ? `${userProfile.name}, ` : ''}Your ${currentTop} and ${currentBottom} combo is comfortable and stylish. ${prefersCasual ? 'This is exactly your style - I love it!' : 'Love it!'} `;
            } else {
                const recommendation = prefersCasual ? 
                    `For casual wear, ${userProfile.name ? `${userProfile.name}, ` : ''}I know this is your favorite style! Here are some great options: <br><br> <strong>Classic White Tee + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Classic Denim Jeans')">Preview This Look</button><br><br> <strong>Elegant Blouse + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Classic Denim Jeans')">Preview This Look</button>` :
                    `For casual wear, I recommend: <br><br> <strong>Classic White Tee + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Classic Denim Jeans')">Preview This Look</button><br><br> <strong>Elegant Blouse + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Classic Denim Jeans')">Preview This Look</button>`;
                
                return recommendation;
            }
        }
        
        function getWeekendResponse(currentTop, currentBottom) {
            return `Weekend vibes! Your ${currentTop} and ${currentBottom} combo is perfect for relaxing and having fun. Enjoy your weekend! `;
        }
        
        function getConcertResponse(currentTop, currentBottom) {
            const concert = ['Classic White Tee', 'Classic Denim Jeans'];
            const isConcert = concert.some(item => currentTop.includes(item) || currentBottom.includes(item));
            
            if (isConcert) {
                return `Rock on! Your ${currentTop} and ${currentBottom} combo is perfect for a concert. You'll be comfortable and look great! `;
            } else {
                return `For a concert, I recommend: <br><br> <strong>Classic White Tee + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Classic Denim Jeans')">Preview This Look</button><br><br> <strong>Professional Button-Up + Classic Denim Jeans</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Classic Denim Jeans')">Preview This Look</button>`;
            }
        }
        
        function getFormalResponse(currentTop, currentBottom) {
            const formal = ['Professional Button-Up', 'Elegant Blouse', 'Formal Trousers'];
            const isFormal = formal.some(item => currentTop.includes(item) || currentBottom.includes(item));
            
            if (isFormal) {
                return `Elegant and sophisticated! Your ${currentTop} and ${currentBottom} combo is perfect for formal occasions. You look amazing! `;
            } else {
                return `For a formal event, I recommend: <br><br> <strong>Professional Button-Up + Formal Trousers</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Formal Trousers')">Preview This Look</button><br><br> <strong>Elegant Blouse + Business Chinos</strong><br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Business Chinos')">Preview This Look</button>`;
            }
        }
        
        function getSleepoverResponse(currentTop, currentBottom) {
            const comfy = ['Classic White Tee', 'White Crewneck Sweater', 'Comfortable Joggers', 'Classic Denim Jeans'];
            const isComfy = comfy.some(item => currentTop.includes(item) || currentBottom.includes(item));
            
            if (isComfy) {
                return `Yeah that's perfect! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}Your ${currentTop} + ${currentBottom} is exactly what you want for a sleepover - super comfy and chill!`;
            } else {
                return `For a sleepover you definitely want something comfy! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}Try something like a white tee with joggers or a cozy sweater with jeans. Nothing too fancy, just something you can relax in!`;
            }
        }
        
        function getFeedbackResponse(message, currentTop, currentBottom) {
            const messageLower = message.toLowerCase();
            
            if (messageLower.includes('too formal') || messageLower.includes('too fancy')) {
                return `Oh totally! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}You're right, that was way too formal for a sleepover. You want something super casual and comfy - like a basic tee with joggers or a cozy sweater with jeans. Nothing fancy at all!`;
            }
            
            if (messageLower.includes('not good') || messageLower.includes('doesn\'t work')) {
                return `Got it! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}What kind of vibe are you going for instead? More casual? Something else?`;
            }
            
            // Generic feedback response
            return `Ah okay! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}What would work better for you?`;
        }
        
        function getItemResponse(itemType, message) {
            const messageLower = message.toLowerCase();
            
            // Handle specific item questions
            if (itemType === 'blue jeans' || itemType === 'jeans') {
            const responses = [
                    `Blue jeans are super versatile! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}They go great with:<br><br> <strong>Classic White Tee</strong> - timeless combo<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Classic Denim Jeans')">Preview</button><br><br> <strong>Professional Button-Up</strong> - smart casual<br><button class="ai-suggestion-btn" onclick="previewLook('Professional Button-Up', 'Classic Denim Jeans')">Preview</button><br><br> <strong>Black Blazer</strong> - elevated look<br><button class="ai-suggestion-btn" onclick="previewLook('Black Blazer', 'Classic Denim Jeans')">Preview</button>`,
                    
                    `Jeans are a wardrobe staple! ${userProfile.name ? `${userProfile.name}, ` : ''}Try pairing them with:<br><br> <strong>White Crewneck Sweater</strong> - cozy and cool<br><button class="ai-suggestion-btn" onclick="previewLook('White Crewneck Sweater', 'Classic Denim Jeans')">Preview</button><br><br> <strong>Elegant Blouse</strong> - feminine touch<br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'Classic Denim Jeans')">Preview</button><br><br> <strong>Brown Casual Shirt</strong> - earthy vibes<br><button class="ai-suggestion-btn" onclick="previewLook('Brown Casual Shirt', 'Classic Denim Jeans')">Preview</button>`
                ];
                return responses[Math.floor(Math.random() * responses.length)];
            }
            
            if (itemType === 'white tee') {
                const responses = [
                    `White tees are classic! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}They work with almost everything:<br><br> <strong>Classic Denim Jeans</strong> - never fails<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Classic Denim Jeans')">Preview</button><br><br> <strong>Black Jeans</strong> - monochrome vibes<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Black Jeans')">Preview</button><br><br> <strong>White Skirt</strong> - clean look<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'White Skirt')">Preview</button>`,
                    
                    `White tees are so versatile! ${userProfile.name ? `${userProfile.name}, ` : ''}Great with:<br><br> <strong>Comfortable Joggers</strong> - relaxed fit<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Comfortable Joggers')">Preview</button><br><br> <strong>Blue Striped Shorts</strong> - summer vibes<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Blue Striped Shorts')">Preview</button><br><br> <strong>Brown Pants</strong> - casual chic<br><button class="ai-suggestion-btn" onclick="previewLook('Classic White Tee', 'Brown Pants')">Preview</button>`
                ];
                return responses[Math.floor(Math.random() * responses.length)];
            }
            
            if (itemType === 'black dress') {
                return `Black dresses are elegant! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}They're perfect on their own, but you can layer with:<br><br> <strong>White Skirt</strong> - layered look<br><button class="ai-suggestion-btn" onclick="previewLook('Black Sleeveless Dress', 'White Skirt')">Preview</button><br><br> <strong>Black Blazer</strong> - professional<br><button class="ai-suggestion-btn" onclick="previewLook('Black Blazer', 'White Skirt')">Preview</button><br><br> <strong>Elegant Blouse</strong> - sophisticated<br><button class="ai-suggestion-btn" onclick="previewLook('Elegant Blouse', 'White Skirt')">Preview</button>`;
            }
            
            if (itemType === 'blazer') {
                return `Blazers are perfect for smart casual! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}Try with:<br><br> <strong>Classic Denim Jeans</strong> - casual blazer look<br><button class="ai-suggestion-btn" onclick="previewLook('Black Blazer', 'Classic Denim Jeans')">Preview</button><br><br> <strong>Formal Trousers</strong> - business ready<br><button class="ai-suggestion-btn" onclick="previewLook('Black Blazer', 'Formal Trousers')">Preview</button><br><br> <strong>White Skirt</strong> - elegant contrast<br><button class="ai-suggestion-btn" onclick="previewLook('Black Blazer', 'White Skirt')">Preview</button>`;
            }
            
            // Generic response for other items
            return `That's a great piece! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}What kind of look are you going for? I can help you find the perfect pairing!`;
        }
        
        function getDefaultResponse(message, currentTop, currentBottom) {
            // Check if user is asking for something specific
            const messageLower = message.toLowerCase();
            
            // Check for specific requests
            if (messageLower.includes('need') || messageLower.includes('want') || messageLower.includes('looking for')) {
                // Generate random outfit recommendations
                const allTops = [
                    'Classic White Tee', 'Black Sleeveless Dress', 'Yellow Vest', 'Brown Casual Shirt',
                    'Grey Loose Shirt', 'Black Blazer', 'Blue Striped T-Shirt', 'White Crewneck Sweater',
                    'White Long Sleeve', 'Elegant Blouse', 'Professional Button-Up'
                ];
                
                const allBottoms = [
                    'Classic Denim Jeans', 'Black Soft Pants', 'Blue Striped Shorts', 'White Skirt',
                    'Black Jeans', 'Blue Denim Jeans', 'Brown Pants', 'Comfortable Joggers',
                    'White Trousers', 'Business Chinos', 'Formal Trousers'
                ];
                
                // Get random combinations (different each time)
                const randomTop1 = allTops[Math.floor(Math.random() * allTops.length)];
                const randomBottom1 = allBottoms[Math.floor(Math.random() * allBottoms.length)];
                const randomTop2 = allTops[Math.floor(Math.random() * allTops.length)];
                const randomBottom2 = allBottoms[Math.floor(Math.random() * allBottoms.length)];
                
                const responses = [
                    `Got it! ${userProfile.name ? `Hey ${userProfile.name}, ` : ''}here are some fresh combos:<br><br> <strong>${randomTop1} + ${randomBottom1}</strong><br><button class="ai-suggestion-btn" onclick="previewLook('${randomTop1}', '${randomBottom1}')">Preview</button><br><br> <strong>${randomTop2} + ${randomBottom2}</strong><br><button class="ai-suggestion-btn" onclick="previewLook('${randomTop2}', '${randomBottom2}')">Preview</button><br><br>What's the vibe? Office, date, party?`,
                    
                    `Nice! ${userProfile.name ? `${userProfile.name}, ` : ''}check these out:<br><br> <strong>${randomTop1} + ${randomBottom1}</strong><br><button class="ai-suggestion-btn" onclick="previewLook('${randomTop1}', '${randomBottom1}')">Preview</button><br><br> <strong>${randomTop2} + ${randomBottom2}</strong><br><button class="ai-suggestion-btn" onclick="previewLook('${randomTop2}', '${randomBottom2}')">Preview</button><br><br>Where you headed?`,
                    
                    `Cool! ${userProfile.name ? `${userProfile.name}, ` : ''}try these:<br><br> <strong>${randomTop1} + ${randomBottom1}</strong><br><button class="ai-suggestion-btn" onclick="previewLook('${randomTop1}', '${randomBottom1}')">Preview</button><br><br> <strong>${randomTop2} + ${randomBottom2}</strong><br><button class="ai-suggestion-btn" onclick="previewLook('${randomTop2}', '${randomBottom2}')">Preview</button><br><br>What's the occasion?`
                ];
            
            return responses[Math.floor(Math.random() * responses.length)];
            } else {
                // Generic conversational responses
                const responses = [
                    `Hey! ${userProfile.name ? `What's up ${userProfile.name}! ` : ''}What's going on?`,
                    `Yo! ${userProfile.name ? `How's it going ${userProfile.name}? ` : ''}What's happening?`,
                    `Hey! ${userProfile.name ? `Good to see you ${userProfile.name}! ` : ''}What's up?`,
                    `What's good? ${userProfile.name ? `Hey ${userProfile.name}! ` : ''}Need help with anything?`,
                    `Hey! ${userProfile.name ? `What's up ${userProfile.name}! ` : ''}Anything I can help with?`
                ];
                return responses[Math.floor(Math.random() * responses.length)];
            }
        }
        
        // Preview specific looks
        function previewLook(suggestTop, suggestBottom) {
            const topItems = document.querySelectorAll('#topCarousel .carousel-item');
            const bottomItems = document.querySelectorAll('#bottomCarousel .carousel-item');
            
            // Find and navigate to suggested items
            for (let i = 0; i < topItems.length; i++) {
                if (topItems[i].dataset.name === suggestTop) {
                    navigateToItem('top', i);
                    break;
                }
            }
            
            for (let i = 0; i < bottomItems.length; i++) {
                if (bottomItems[i].dataset.name === suggestBottom) {
                    navigateToItem('bottom', i);
                    break;
                }
            }
            
            updateComboDisplay();
            addMessageToChat(` Previewing: ${suggestTop} + ${suggestBottom}`, 'ai');
        }
        
        function navigateToItem(type, index) {
            const items = document.querySelectorAll(`#${type}Carousel .carousel-item`);
            const currentItem = items[type === 'top' ? currentTopIndex : currentBottomIndex];
            currentItem.classList.remove('active');
            currentItem.classList.add('prev');
            
            if (type === 'top') currentTopIndex = index;
            else currentBottomIndex = index;
            
            const nextItem = items[index];
            nextItem.classList.add('active');
            nextItem.classList.remove('prev');
            
            setTimeout(() => {
                currentItem.classList.remove('prev');
            }, 600);
        }
        
        // Allow Enter key to send message
        document.getElementById('aiInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        function getSmartRecommendation(occasion, currentTop, currentBottom, currentOccasion) {
            const occasionLower = occasion.toLowerCase();
            
            // Define outfit recommendations based on occasion
            const recommendations = {
                'office': {
                    good: ['Professional Button-Up', 'Business Chinos', 'Formal Trousers'],
                    bad: ['Classic White Tee', 'Classic Denim Jeans'],
                    message: 'For the office, I recommend switching to more professional pieces. Try the Professional Button-Up with Business Chinos for a polished look.',
                    suggestTop: 'Professional Button-Up',
                    suggestBottom: 'Business Chinos'
                },
                'meeting': {
                    good: ['Professional Button-Up', 'Business Chinos', 'Formal Trousers', 'Elegant Blouse'],
                    bad: ['Classic White Tee', 'Classic Denim Jeans'],
                    message: 'For an important meeting, consider upgrading to the Professional Button-Up or Elegant Blouse with Formal Trousers for maximum impact.',
                    suggestTop: 'Professional Button-Up',
                    suggestBottom: 'Formal Trousers'
                },
                'date': {
                    good: ['Elegant Blouse', 'Professional Button-Up', 'Classic White Tee'],
                    bad: ['Formal Trousers'],
                    message: 'For a date night, the Elegant Blouse would be perfect! It\'s sophisticated yet approachable. Pair it with the Business Chinos for a romantic dinner look.',
                    suggestTop: 'Elegant Blouse',
                    suggestBottom: 'Business Chinos'
                },
                'casual': {
                    good: ['Classic White Tee', 'Classic Denim Jeans'],
                    bad: ['Formal Trousers', 'Professional Button-Up'],
                    message: 'For casual outings, your current Classic White Tee and Denim Jeans combo is perfect! It\'s comfortable and stylish for everyday wear.',
                    suggestTop: 'Classic White Tee',
                    suggestBottom: 'Classic Denim Jeans'
                },
                'weekend': {
                    good: ['Classic White Tee', 'Classic Denim Jeans', 'Elegant Blouse'],
                    bad: ['Formal Trousers'],
                    message: 'Weekend vibes! Your current outfit works great, but if you want to dress it up slightly, try the Elegant Blouse with your current jeans.',
                    suggestTop: 'Elegant Blouse',
                    suggestBottom: 'Classic Denim Jeans'
                },
                'concert': {
                    good: ['Classic White Tee', 'Classic Denim Jeans'],
                    bad: ['Professional Button-Up', 'Formal Trousers'],
                    message: 'Perfect for a concert! Your current casual look is ideal. The Classic White Tee and Denim Jeans combo will keep you comfortable while you rock out!',
                    suggestTop: 'Classic White Tee',
                    suggestBottom: 'Classic Denim Jeans'
                },
                'party': {
                    good: ['Elegant Blouse', 'Professional Button-Up'],
                    bad: ['Classic White Tee'],
                    message: 'For a party, let\'s elevate your look! The Elegant Blouse would be perfect - it\'s stylish and party-ready. Pair it with the Business Chinos for a sophisticated party look.',
                    suggestTop: 'Elegant Blouse',
                    suggestBottom: 'Business Chinos'
                }
            };
            
            // Find matching recommendation
            for (const [key, rec] of Object.entries(recommendations)) {
                if (occasionLower.includes(key)) {
                    const isGoodMatch = rec.good.some(item => 
                        currentTop.includes(item) || currentBottom.includes(item)
                    );
                    
                    if (isGoodMatch) {
                        return ` Perfect choice for ${occasion}! Your current outfit (${currentTop} + ${currentBottom}) is ideal for this occasion. ${rec.message}`;
                    } else {
                        // Store recommendations for potential navigation
                        window.currentRecommendation = rec;
                        return ` For ${occasion}, I suggest: ${rec.message} <br><button class="ai-suggestion-btn" onclick="applyRecommendation()">Apply This Look</button>`;
                    }
                }
            }
            
            // Default recommendation
            return ` For ${occasion}, consider the context: Is it formal or casual? Your current ${currentTop} + ${currentBottom} combo works for many occasions, but I can help you find the perfect match!`;
        }
        
        function applyRecommendation() {
            if (!window.currentRecommendation) return;
            
            const { suggestTop, suggestBottom } = window.currentRecommendation;
            
            // Find and navigate to suggested items
            const topItems = document.querySelectorAll('#topCarousel .carousel-item');
            const bottomItems = document.querySelectorAll('#bottomCarousel .carousel-item');
            
            // Find top item
            for (let i = 0; i < topItems.length; i++) {
                if (topItems[i].dataset.name === suggestTop) {
                    // Navigate to this top
                    const currentItem = topItems[currentTopIndex];
                    currentItem.classList.remove('active');
                    currentItem.classList.add('prev');
                    
                    currentTopIndex = i;
                    const nextItem = topItems[currentTopIndex];
                    nextItem.classList.add('active');
                    nextItem.classList.remove('prev');
                    
                    setTimeout(() => {
                        currentItem.classList.remove('prev');
                    }, 600);
                    break;
                }
            }
            
            // Find bottom item
            for (let i = 0; i < bottomItems.length; i++) {
                if (bottomItems[i].dataset.name === suggestBottom) {
                    // Navigate to this bottom
                    const currentItem = bottomItems[currentBottomIndex];
                    currentItem.classList.remove('active');
                    currentItem.classList.add('prev');
                    
                    currentBottomIndex = i;
                    const nextItem = bottomItems[currentBottomIndex];
                    nextItem.classList.add('active');
                    nextItem.classList.remove('prev');
                    
                    setTimeout(() => {
                        currentItem.classList.remove('prev');
                    }, 600);
                    break;
                }
            }
            
            // Update the display
            updateComboDisplay();
            
            // Show success message
            const message = document.getElementById('aiMessage');
            message.innerHTML = ' Applied the recommended look! How do you like it?';
            message.classList.add('show');
            
            setTimeout(() => {
                message.classList.remove('show');
            }, 3000);
        }

        // Quiz Functions
        function startQuiz() {
            document.getElementById('quizModal').classList.add('active');
        }

        function selectGender(gender) {
            document.querySelectorAll('#quizStep2 .quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            quizData.gender = gender;
            document.getElementById('quizNext2').disabled = false;
            document.getElementById('quizNext2').style.background = '#9CAF88';
            document.getElementById('quizNext2').style.cursor = 'pointer';
        }

        function toggleStyle(style) {
            const option = event.target.closest('.quiz-option');
            if (quizData.selectedStyles.includes(style)) {
                option.classList.remove('selected');
                quizData.selectedStyles = quizData.selectedStyles.filter(s => s !== style);
            } else {
                if (quizData.selectedStyles.length < 10) {
                    option.classList.add('selected');
                    quizData.selectedStyles.push(style);
                }
            }
            updateQuizNextButton();
        }

        function nextQuizStep() {
            if (currentQuizStep === 1) {
                const name = document.getElementById('quizName').value.trim();
                if (!name) {
                    alert('Please enter your name');
                    return;
                }
                quizData.name = name;
            } else if (currentQuizStep === 3) {
                if (quizData.selectedStyles.length < 5) {
                    alert('Please select at least 5 styles');
                    return;
                }
            }
            
            document.getElementById(`quizStep${currentQuizStep}`).style.display = 'none';
            currentQuizStep++;
            document.getElementById(`quizStep${currentQuizStep}`).style.display = 'block';
            
            if (currentQuizStep === 4) {
                document.getElementById('quizResultName').textContent = quizData.name;
            }
        }

        function completeQuiz() {
            // Save quiz data
            localStorage.setItem('userProfile', JSON.stringify(quizData));
            
            // Update AI user profile with quiz data
            userProfile.name = quizData.name;
            userProfile.gender = quizData.gender;
            userProfile.style = quizData.selectedStyles.join(', ');
            
            // Update welcome message
            document.getElementById('userName').textContent = quizData.name;
            
            // Add welcome message to chat
            addMessageToChat(`Welcome to atyr, ${quizData.name}! I'm your personal stylist and I'm excited to help you find the perfect outfits. I see you're into ${quizData.selectedStyles.join(', ')} styles - that's great! What can I help you with today?`, 'ai');
            
            // Close quiz modal
            document.getElementById('quizModal').classList.remove('active');
            
            // Reset quiz
            currentQuizStep = 1;
            quizData = { name: '', gender: '', selectedStyles: [] };
        }

        function updateQuizNextButton() {
            const nextBtn = document.getElementById('quizNext3');
            if (quizData.selectedStyles.length >= 5) {
                nextBtn.disabled = false;
                nextBtn.style.background = '#9CAF88';
                nextBtn.style.cursor = 'pointer';
            } else {
                nextBtn.disabled = true;
                nextBtn.style.background = '#ccc';
                nextBtn.style.cursor = 'not-allowed';
            }
        }

        function updateStats() {
            document.getElementById('fitsMade').textContent = stats.fitsMade;
            document.getElementById('timeSpent').textContent = stats.timeSpent;
            document.getElementById('combosSaved').textContent = stats.combosSaved;
        }

        // Event Listeners

        // Lightbox Functions
        function openLightbox(item) {
            const lightbox = document.getElementById('lightboxOverlay');
            const sizes = item.dataset.sizes.split(',');
            
            document.getElementById('lightboxImage').src = item.querySelector('img').src;
            document.getElementById('lightboxTitle').textContent = item.dataset.name;
            document.getElementById('lightboxBrand').textContent = item.dataset.brand;
            document.getElementById('lightboxPrice').textContent = '$' + item.dataset.price;
            document.getElementById('lightboxDescription').textContent = item.dataset.description;
            
            // Create size options
            const sizesContainer = document.getElementById('lightboxSizes');
            sizesContainer.innerHTML = '';
            sizes.forEach(size => {
                const sizeOption = document.createElement('div');
                sizeOption.className = 'size-option';
                sizeOption.textContent = size.trim();
                sizeOption.onclick = () => selectSize(sizeOption);
                sizesContainer.appendChild(sizeOption);
            });
            
            lightbox.classList.add('active');
        }
        
        function closeLightbox() {
            document.getElementById('lightboxOverlay').classList.remove('active');
        }
        
        function selectSize(option) {
            document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
        }
        
        function addToCart() {
            const selectedSize = document.querySelector('.size-option.selected');
            if (!selectedSize) {
                alert('Please select a size');
                return;
            }
            alert('Added to cart!');
            closeLightbox();
        }
        
        // Swipe functionality
        let startX = 0;
        let startY = 0;
        let isDragging = false;
        
        function addSwipeListeners() {
            const carousels = document.querySelectorAll('.carousel');
            carousels.forEach(carousel => {
                carousel.addEventListener('touchstart', handleTouchStart, { passive: false });
                carousel.addEventListener('touchmove', handleTouchMove, { passive: false });
                carousel.addEventListener('touchend', handleTouchEnd, { passive: false });
                
                carousel.addEventListener('mousedown', handleMouseDown);
                carousel.addEventListener('mousemove', handleMouseMove);
                carousel.addEventListener('mouseup', handleMouseUp);
                carousel.addEventListener('mouseleave', handleMouseUp);
            });
        }
        
        function handleTouchStart(e) {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
            isDragging = true;
        }
        
        function handleTouchMove(e) {
            if (!isDragging) return;
            e.preventDefault();
        }
        
        function handleTouchEnd(e) {
            if (!isDragging) return;
            isDragging = false;
            
            const endX = e.changedTouches[0].clientX;
            const endY = e.changedTouches[0].clientY;
            const diffX = startX - endX;
            const diffY = startY - endY;
            
            // Only handle horizontal swipes
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                const carousel = e.target.closest('.carousel');
                if (diffX > 0) {
                    // Swipe left - next item
                    if (carousel.id === 'topCarousel') nextItem('top');
                    else nextItem('bottom');
                } else {
                    // Swipe right - previous item
                    if (carousel.id === 'topCarousel') previousItem('top');
                    else previousItem('bottom');
                }
            }
        }
        
        function handleMouseDown(e) {
            startX = e.clientX;
            startY = e.clientY;
            isDragging = true;
        }
        
        function handleMouseMove(e) {
            if (!isDragging) return;
            e.preventDefault();
        }
        
        function handleMouseUp(e) {
            if (!isDragging) return;
            isDragging = false;
            
            const endX = e.clientX;
            const endY = e.clientY;
            const diffX = startX - endX;
            const diffY = startY - endY;
            
            // Only handle horizontal swipes
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                const carousel = e.target.closest('.carousel');
                if (diffX > 0) {
                    // Swipe left - next item
                    if (carousel.id === 'topCarousel') nextItem('top');
                    else nextItem('bottom');
                } else {
                    // Swipe right - previous item
                    if (carousel.id === 'topCarousel') previousItem('top');
                    else previousItem('bottom');
                }
            }
        }
        
        // Initialize outfit lookbook
        updateComboDisplay();
        
        // Add swipe listeners after DOM is loaded
        setTimeout(addSwipeListeners, 100);
        
        // AI Recommendation Functions
        function showRecommendedFit(topName, bottomName) {
            // Find the items in the carousel
            const topItems = document.querySelectorAll('#topCarousel .carousel-item');
            const bottomItems = document.querySelectorAll('#bottomCarousel .carousel-item');
            
            let topIndex = -1;
            let bottomIndex = -1;
            
            // Find the matching items
            topItems.forEach((item, index) => {
                if (item.dataset.name === topName) {
                    topIndex = index;
                }
            });
            
            bottomItems.forEach((item, index) => {
                if (item.dataset.name === bottomName) {
                    bottomIndex = index;
                }
            });
            
            // If items found, navigate to them
            if (topIndex !== -1 && bottomIndex !== -1) {
                // Navigate to the recommended top
                navigateToItem('top', topIndex);
                // Navigate to the recommended bottom
                navigateToItem('bottom', bottomIndex);
                
                // Show success message
                addMessageToChat(` Perfect! I've shown you the recommended fit: ${topName} + ${bottomName}. This combination will look amazing!`, 'ai');
            } else {
                addMessageToChat(`Sorry, I couldn't find those specific items. Let me suggest some alternatives!`, 'ai');
            }
        }
        
        function previewLook(topName, bottomName) {
            // Show a preview message
            addMessageToChat(` Here's a preview of ${topName} + ${bottomName}. This would be perfect for your occasion!<br><br><button class="ai-recommend-btn" onclick="showRecommendedFit('${topName}', '${bottomName}')"> Show This Recommended Fit</button>`, 'ai');
        }
        
        function navigateToItem(type, targetIndex) {
            if (type === 'top') {
                const items = document.querySelectorAll('#topCarousel .carousel-item');
                const currentItem = items[currentTopIndex];
                currentItem.classList.remove('active');
                currentItem.classList.add('prev');
                
                currentTopIndex = targetIndex;
                const targetItem = items[currentTopIndex];
                targetItem.classList.add('active');
                targetItem.classList.remove('prev');
                
                setTimeout(() => {
                    currentItem.classList.remove('prev');
                }, 600);
            } else {
                const items = document.querySelectorAll('#bottomCarousel .carousel-item');
                const currentItem = items[currentBottomIndex];
                currentItem.classList.remove('active');
                currentItem.classList.add('prev');
                
                currentBottomIndex = targetIndex;
                const targetItem = items[currentBottomIndex];
                targetItem.classList.add('active');
                targetItem.classList.remove('prev');
                
                setTimeout(() => {
                    currentItem.classList.remove('prev');
                }, 600);
            }
            
            updateComboDisplay();
        }

        // AI Chat Functions
        async function sendMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Clear input
            input.value = '';
            
            // Add user message to chat
            addMessageToChat(message, 'user');
            
            // Show typing indicator
            const typingIndicator = addTypingIndicator();
            
            try {
                // Get AI response
                const aiResponse = await getAIResponse(message);
                
                // Remove typing indicator
                removeTypingIndicator(typingIndicator);
                
                // Add AI response to chat
                addMessageToChat(aiResponse, 'ai');
                
            } catch (error) {
                console.error('Error getting AI response:', error);
                removeTypingIndicator(typingIndicator);
                addMessageToChat('Sorry, I encountered an error. Please try again!', 'ai');
            }
        }
        
        function addTypingIndicator() {
            const chatContainer = document.getElementById('chatContainer');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-bubble ai-bubble typing-indicator';
            typingDiv.innerHTML = `
                <div class="message-content">
                    <span class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </div>
            `;
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            return typingDiv;
        }
        
        function removeTypingIndicator(typingDiv) {
            if (typingDiv && typingDiv.parentNode) {
                typingDiv.parentNode.removeChild(typingDiv);
            }
        }
        
        // Allow Enter key to send message
        document.addEventListener('DOMContentLoaded', function() {
            const aiInput = document.getElementById('aiInput');
            if (aiInput) {
                aiInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
        });

        // Cool Intro Animation
        function initIntroAnimation() {
            const introAnimation = document.getElementById('introAnimation');
            
            // Show intro animation for 3 seconds
            setTimeout(() => {
                introAnimation.classList.add('hidden');
                
                // Remove from DOM after animation completes
                setTimeout(() => {
                    introAnimation.style.display = 'none';
                }, 1200);
            }, 3000);
        }

        // Initialize intro animation when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initIntroAnimation();
        });
    </script>
</body>
</html>
<!-- Force Vercel redeploy 09/29/2025 00:15:00 - Latest version -->
< ! - -   F o r c e   V e r c e l   r e d e p l o y   0 9 / 2 8 / 2 0 2 5   2 2 : 4 5 : 4 4   - - > 
 

 
